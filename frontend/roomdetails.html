<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Room Details - Bachelors</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="room-listings-container">
    <h1>Browse Rooms</h1>
    <div id="room-listings" class="room-listings"></div>
  </div>

  <script>
    async function fetchRooms(location) {
      const res = await fetch(`http://localhost:5000/api/rooms?location=${encodeURIComponent(location)}`);
      const rooms = await res.json();

      const roomListingsContainer = document.getElementById("room-listings");
      roomListingsContainer.innerHTML = '';

      rooms.forEach(room => {
        const roomDiv = document.createElement("div");
        roomDiv.classList.add("room");

        roomDiv.innerHTML = `
          <h3>${room.title}</h3>
          <p>${room.description}</p>
          <p><strong>Location:</strong> ${room.location}</p>
          <p><strong>Rent:</strong> â‚¹${room.rent}</p>
          ${room.image ? `<img src="${room.image}" alt="${room.title}" class="room-image" />` : ''}
          <a href="room-details.html?id=${room._id}">View Details</a>
        `;

        roomListingsContainer.appendChild(roomDiv);
      });
    }

    function getLocationFromQuery() {
      const params = new URLSearchParams(window.location.search);
      return params.get('location') || '';
    }

    document.addEventListener('DOMContentLoaded', () => {
      const location = getLocationFromQuery();
      fetchRooms(location);
    });
  </script>
</body>
</html>
